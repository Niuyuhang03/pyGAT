# 数据集

+ 数据处理项目，代码为[OpenKE](https://github.com/Niuyuhang03/OpenKE)的`GAT_data_process`分支。其中部分原始数据由[DKRL](https://github.com/xrb92/DKRL)得到，具体数据来源见运行文件注释。

+ 运行方法：直接运行`./FB15K237_result/FB15K237_process.py`、`./WN18RR/WN18RR_process.py`、`./WN18RR/WN18RR_sub30000_process.py`，会生成新数据文件`.content`、`.rel`、`.cites`，输出统计信息。

+ 数据详情：

  + FB15K237共14414个实体，237种关系，25种label，297846个三元组。实体和关系的embeddings都为100维。**每种labels**的分布如下：

    ![1566466080813](C:\Users\14114\AppData\Roaming\Typora\typora-user-images\1566466080813.png)

  + WN18RR共40943个实体，11种关系，4种label，93003个三元组。实体和关系的embeddings都为100维。**实体和labels**的分布如下：

    ![1566463889752](C:\Users\14114\AppData\Roaming\Typora\typora-user-images\1566463889752.png)

  + WN18RR_sub30000共30943个实体，11种关系，4种label，37219个三元组。实体和关系的embeddings都为100维。相比WN18RR，删除了10000个标签为n的实体。**实体和labels**的分布如下：

    ![1566463781027](C:\Users\14114\AppData\Roaming\Typora\typora-user-images\1566463781027.png)

+ 注意事项：重新运行代码可能会在git提示输出文件内容有修改，实际为输出内容的label顺序更换，但内容未变化。

+ 数据集运行时间

    |  数据集   |  实体/关系  |dataset.content|dataset.cites|dataset.rel|classes|数据处理时间|运行1个epoch时间|总时间|
    | :-------: | :--------: | :-----------: | :---------: | :------: | :-----: | :----: | :----: | :------: |
    |   cora    |    实体    |  2708\*1433   |     5429    |    -     |    7    |   6s   |  0.05s |   30s    |
    | FB15K-237 |    实体    |  14414\*100   |    297846   |    -     |   25    |   11s  | 2min30s|   34h    |
    | FB15K-237 |    关系    |  14414\*100   |    297846   | 237\*100 |   25    |   11s  | 3min30s|   18h    |
    |   WN18RR  |    实体    |  40943\*100   |    93003    |    -     |    4    |   43s  |  26min |45h(100 epochs)|
    |   WN18RR  |    关系    |  40943\*100   |    93003    |  11\*100 |    4    |   43s  |17min10s|   44h    |
    | WN18RR_sub30000 | 实体 |  30943\*100   |    71009    |    -     |    4    |   25s  |        |          |
    | WN18RR_sub30000 | 关系 |  30943\*100   |    71009    |  11\*100 |    4    |   26s  |10min30s|   39h    |


# pyGAT

## 注意

+ 在关系gat中，nhidden参数无效。关系gat的层，输入和输出的列数必须相同，层内没有修改列维度的操作。

## 实验结果

### GAT参数

### 关系GAT第一层nhead对比实验

| nheads|实体FB15K-237|关系FB15K-237拼接|关系FB15K-237平均|
| :---: | :---------: | :------------: | :------------: |
|   30  |             |                |                |
|   50  |             |                |                |

### 关系GAT第二层采用拼接/平均对比实验

+ FB15K-237中，nheads为50。
+ WN18RR和WN18RR_sub30000中，nheads为10。

|        |FB15K-237| WN18RR |WN18RR_sub30000|
| :----: | :-----: | :----: | :-----------: |
|  拼接  |         |        |     0.8467    |
|  平均  |         |        |     0.8231    |

### GAT结果和baseline结果

|              |     cora   |  FB15K-237 |   WN18RR   |WN18RR_sub30000|
| :----------: | :--------: | :--------: | :---------:| :---------:|
|    实体GAT   | **0.8200** |   0.2952   |0.8609(100 epochs)|      |
|    关系GAT   |      -     |   0.4434   |   0.8592   |   0.8666   |
| RDF2VEC(nb)  |   0.4892   |   0.0189   |   0.6919   |   0.6936   |
| RDF2VEC(svm) |   0.3021   |   0.1604   |   0.7817   |   0.7823   |
|     R-GCN    |   0.7374   | **0.5395** | **0.9759** | **0.9621** |
